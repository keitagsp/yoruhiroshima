###############################################################################################
##
#  PHP営業日カレンダー【Calendar02】　テキスト入力追加 フリー版　ver1.0.1 (2020.07.30アップデート)
#
#  営業日カレンダープログラムです。
#　任意のページにiframeで埋め込んで営業日カレンダーやお知らせカレンダーとして運用できます。
#  改造や改変は自己責任で行ってください。
#	
#  不具合等がありましたら下記までご連絡ください。
#  MailAddress: info@php-factory.net
#  name: K.Numata
#  HP: http://www.php-factory.net/
#
##
###############################################################################################

以下内容はサイト内にも同様の内容がありますのでサイト内を御覧ください。
サイトのほうが新しい記事である場合があります。

■主な機能

・カレンダープログラムです。もちろん商用サイトでもどんなサイトでも設置OKです。

・管理画面から登録、編集できるので完全自動化（CMS）として運用可能です。

・スマホ（スマートフォン）、携帯用に最適化したファイルも同梱しています（サンプル参照）。

・設定ファイルにて細かい設定が可能で実務での様々な運用に対応します。

・デフォルトデザインはシンプルですが、CSSを編集すればオリジナルデザインも可能。
　特に幅などは設置するページに合わせて変更して下さい。

・スマホ（スマートフォン）、携帯（ガラケー）用に最適化したファイルも同梱していますので、3デバイス同時更新が可能です。

・設置が容易。ページ内でカレンダーを表示させたい場所にiframeタグ1行を記述すれば表示側の設置は完了します。

・定休日設定（たとえば毎週月曜日）が可能で、設定すれば全期間で有効になります。
※ただし隔週は不可なので隔週の場合は通常通りチェックを「On」にて反映してください。

・カレンダーは何ヶ月後まで表示させるかなどの設定が可能です。

・祝日は赤字で表示され、GoogleAPIから自動で取得されます。こちらの詳細が以下「注意点」にありますのでご一読ください。 

・日付ごとにコメントも入力可能ですので、様々な用途に使用できるかと思います。



■動作環境
PHPバージョン5〜5.3まで動作確認済

推奨ブラウザ：IE（8以上）、Firefox、GoogleChrome（Mac環境では動作テストしておりません）
※IE6〜IE7でもテスターでは問題ないことを確認しています。JSは特に使用していませんので、ブラウザ間の問題は起こりにくいと思います。

■ 設置方法　
※サイト内が最新である可能性があるので、できればサイト内の設置法をご覧ください。

ファイルの文字コードは基本的にUTF-8です。必ず対応したエディタで開いてください。
メモ帳（UTF-8非対応）は使用禁止です。ファイルが壊れます。TeraPad（無料）やDreamWeaver等で開いてください。
DWだとコードに色付けされ分かりやすいのでおすすめです。
※ PHPでは、スラッシュ2回「//」の後からその行の末尾までがコメント扱いとなります。コード内に複数あります。「#」もです。


◆1.ファイル構成を確認し、表示側の設定を行う（iframeタグを埋め込む等）

ダウンロードしたzipファイルを解凍するとcalendar02フォルダがあります。
・index.php 	PC用のカレンダーを表示するファイルです。実際にはこれをトップページなどの任意の箇所にiframeタグで読み込むことになると思います。もちろん幅を広く表示させたい場合、任意のページに表示させてもOKです。その場合CSSで幅などを調整して下さい。
・Readme.txt 	設置法、利用規約など。
・admin.php 	管理画面です。登録や変更を行います。クライアントにはこのURLだけを教えることになるかと思います。
・complete.php 	「更新」による2重登録防止用のリダイレクトファイルです。そのまま置いておきましょう。
・config.php 	設定ファイル。管理画面ログイン情報の設定やその他設定、関数記述など
・style.css 	admin.php、index.php、sp.phpのスタイルを記述してます(もちろん独自のCSSでもOKです)必要に応じて自由に変更して下さい。
・data/ 	データ保存用ディレクトリ
　┗ holiday_set.dat 	休業日データを保存するファイル
（パーミッション666等書き込み可能なものに）
　┗ comment_set.dat 	コメントデータを保存するファイル
（パーミッション666等書き込み可能なものに）
　┗ closed.dat 	定休日データを保存するファイル
　┗ 西暦_holiday.dat 	祝日データを保存するファイルです。年が切り替わるタイミングでGoogleAPIより祝日データを自動で取得、保存します。Googleの仕様により祝日データが正確では無い場合は直接編集も可能です。登録データを参考に変更下さい。
sp.php 	スマホ用のカレンダーです。このファイルにリンクさせる形になるかと思いますが、iframeで読み込んでもOKです。（iframeタグはほとんどのスマホで対応しているかと思いますが保証はできません）
i.php 	携帯（）用のカレンダーです。携帯はiframeに対応していな機種がほとんどかと思うので、このファイルにリンクさせる形になるかと思います。

 
◆2. ユーザID、パスワードを設定する

config.phpをエディタソフトで開き、ログインのためのID、パスワードを変更してください。
初期値は
ID：admin
パスワード：1397
になっています。必ず変更してください。その他必要に応じてコメントを参考に設定してください。


◆3. FTPでアップ

「calendar02」フォルダごと全ファイルをアップし、
「data」ディレクトリのパーミッションを書き込み可能な755 or 777等に設定（サーバーによる）
data/holiday_set.datのパーミッションを書き込み可能な666等に設定（サーバーによる）
data/comment_set.datのパーミッションを書き込み可能な666等に設定（サーバーによる）
data/closed.dat.datのパーミッションを書き込み可能な666等に設定（サーバーによる）ｓ
にしてください。 これで完了です。

各パーミッションの適切な値はサーバーのマニュアル等を参考に変更下さい。
サーバーによっては値が違う、または変更の必要自体無いこともあります。
もしパーミッションの設定が間違っていた場合ですが、すべての環境での保証はありませんが
管理画面にてその旨警告が表示されるよう設定しています。
またもしパーミッションが間違いの場合には「data」ディレクトリの場合、祝日データが取得できない、
また、holiday_set.dat、closed.datの場合、新規登録時にエラーで登録自体ができません。
要するにまともに動かないのでテスト段階ですぐに気付けます。
逆にそのようなことがない場合は適切なパーミッションになっていると考えてOKです。
ちなみにエックスサーバーの場合、今のところパーミッション変更は不要です。


◆4.登録テストとブラウザで結果確認

ブラウザで「あなたのサイトのURL」/calendar02/admin.phpを表示し、管理画面にログインし、登録を行ってみてください。正常に登録、編集できればOKです。定休日設定も確認下さい。
ifirameなどで埋め込んだページもブラウザで確認してみて下さい。
登録データが反映されていればOKです。


◆5. ページの調整

設置するページやその他必要に応じてスタイルシート、HTML等で見た目の調整を行ってください。じゆ〜です！
カレンダー部分のhtmlはconfig.php内下部に各デバイス（PC用、スマホ用、携帯用）ごとに記述しています。


		
■ 更新履歴
-----------------------------------------------------------------------------------------------------------------------

2020.07.27　セキュリティ強化に伴うアップデートを実施しました。（CSRF対策とセッション名の変更）
2014.02.01　インラインフレーム（iframe）での設置のみを考慮していましたが、既存のページにも直接埋め込めるよう修正しました。(但しUTF-8のみ)
2014.1.18　v1.0.0　配布開始


■ご利用規約

・無料版プログラムはフリーウェアです。ただし、著作権は放棄するものではありません。
　また、カスタマイズ依頼、著作権表示リンク削除依頼にて表示を削除したとしても著作権は放棄しません。
・プログラムによって何らかの不利益、損害が生じても一切の責任を負いません。
　あらかじめご了承の上ご使用ください。
　もし何らかのトラブルがあった場合には、ご相談いただければ解決策が見つかるかもしれません。
　（クライアントへの原因の説明など）
・プログラムは全ての環境（サーバー）での動作を保証するものではありません。
・プログラムの著作権表示リンクを削除することはできません。（削除依頼をいただいた場合を除く）
・改変等は自己責任でお願いします。
・有料版をご購入いただいた場合、初期不良を除き、使用後の返金には応じ兼ねます。
・有料版は1サイト内であれば複数利用可能です。2サイト目以降は都度サイトより購入申込みが必要になります。
・プログラムの再配布は禁止しております。

　ダウンロードいただいた時点で利用規約に同意したものとみなされます。


■著作権表示削除について

ページ下部著作権表示リンクの削除には1サイトあたり2,000円の使用料金が必要になります。
2サイト目以降は都度料金が必要になります。
お支払いは銀行振込、またはPayPal（クレジットカード）となります。

ご希望の際は以下URL内「著作権表示削除について」よりお申込みをお願いいたします。
http://www.php-factory.net/calendar/02.php

振込先をお送りいたしますので、そちらにご入金後こちらから必要なファイルを送付させていただきます。
※正常に動作することをご確認後、申請を行なってください。初期不良以外入金後の返金は致しかねますのでご了承ください。

問題等が発生した場合は相談してみてください。解決策が見つかるかもしれません。


■カスタマイズ、設置代行について

PC、携帯、スマホサイトへの設置代行（各3,000円）、カスタマイズ（2,000円〜）にも対応いたしますのでご相談ください。
実装が難しいもの、まったく違うものに作り変えるなどは対応出来かねる場合もございます。

+++--------------------------------------------------------+
PHP工房 各種お問い合わせは「お問い合わせ」よりお願いします。
http://www.php-factory.net/
+--------------------------------------------------------+++

